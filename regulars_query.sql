with sum_table (st1,end1,ACCOUNTID, ZONENUMBER, summary) as (
SELECT
DATE(START_TIME/1000,'unixepoch') as START_TIME1 ,
DATE(END_TIME/1000,'unixepoch') as END_TIME1,
ACCOUNTID,
ZONENUMBER,
SUM(END_TIME-START_TIME) OVER(PARTITION BY ACCOUNTID,ZONENUMBER) as summary
FROM TEMPORARY3 t 
WHERE END_TIME1 > '2020-12-31'
AND END_TIME1 < '2021-03-01'
AND START_TIME1 > '2020-12-31'
AND START_TIME1 < '2021-03-01'
)
SELECT ACCOUNTID ,ZONENUMBER , MAX(summary) as max_time
from sum_table
group by ACCOUNTID
having max_time > 5*60*60*1000
